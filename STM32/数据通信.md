# 数据通信

作者：嵌入式软件小组:pen:

## 1.数据通信的基本概念：

#### 1.1 单片机中的数据通信：

- **单片机**和**单片机**之间的数据通信:vibration_mode:

- **单片机**和**上位机**之间的数据通信:walking:
- **单片机**和**外围器件**之间的数据通信:sailboat:

<img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/PIC18F8720.jpg" alt="PIC18F8720" style="zoom:50%;" />

#### 1.2 数据通信产生的原因：

- **单片机**通常需要与**外部传感器设备**进行通信，以便获取数据、控制设备。
- **单片机**可能需要将生成的数据存储在**内部存储器**或**外部存储设备**中，这就需要与存储器进行通信。
- **多个单片机**可能需要相互通信，以协同工作或交换信息。

![img](https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/series_lr-x_features_02-01_1981476.jpg)

#### 1.3 通信中的协议/接口：

- 用来通信的设备之间的电气特性、传输速率、可靠性要求等各不相同，因此不同设备之间的通信要满足某种**协议**。
- 我们最常用的协议有：**RS-232**、**RS-485**、**IIC**、**SPI**、**CAN**、**USB**等。

![image-20231010150525050](https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/image-20231010150525050.png)

## 2.数据通信的方式：

#### 2.1 按照传输位数分类：

- **串行通信—Serial communication**：

  - 在**计算机总线**或其他**数据通道**上，每次传输一个**比特**数据，并连续进行以上单次过程的通信方式。
  - 串行通信被用于**长距离通信**以及大多数**计算机网络**，在这些场合中，**并行通信**会面临很大困难。
  - **串行通信**改善了**信号完整性**、提高了**传播速度**、解决了**时钟偏移**等问题，在很多要求较高的传输中，代替**并行通信**。
    - 例如：**PCI   ——>   PCI-Express**，由并行总线升级为串行总线。
      - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/Pci-slots.jpg" alt="Pci-slots" style="zoom:50%;" />

  - 常见的**串行通信**接口/协议：
    - **RS-232**：	
      - **RS-232**是美国**电子工业联盟**(EIA)制定的**串行数据通信**的接口标准，是计算机**串口**的**标准接口**。
      - 在早期的**PC机**上，我们能够看到**COM1**和**COM2**接口，这就是**RS-232接口**。
        - 目前的**PC机**已经见不到**RS-232接口**(不要跟我讲你的电脑还有**RS-232**:dagger:)，当然还是可以在一些**开发板**上见到的。
        - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/img_v2_11bf715d-a2b7-4989-adfd-caf123852f1g.jpg" alt="img_v2_11bf715d-a2b7-4989-adfd-caf123852f1g" style="zoom:50%;" />
      - 早期的**RS-232**是**25针**的接口，目前已不再使用**25针**的接口，取而代之的是**9针**的接口。
      - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/RS-232.jpeg" alt="RS-232" style="zoom:50%;" />
    - **RS-485**：
      - 目前，**RS-485**更正式的叫法是**EIA-485**。
      - 该标准可以在有**电子噪声**的环境下进行长距离有效率的通信，通常用于**工业环境**中。
      - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/img_v2_bb9cbb35-f56a-4916-80d1-e7618fd6c71g.jpg" alt="img_v2_bb9cbb35-f56a-4916-80d1-e7618fd6c71g" style="zoom:50%;" />
        - (上图中，**绿色/蓝色**的**三线接口**是**RS-485接口**)
    - **IIC**：
      - **Inter-Integrated Circuit—集成电路总线**，使用多主从架构，用于**芯片间**通信。
      - 1980年，**飞利浦**公司研发**IIC总线**。
      - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/1280px-Medion_MD8910_-_STMicroelectronics_24C08-8003.jpg" alt="1280px-Medion_MD8910_-_STMicroelectronics_24C08-8003" style="zoom:50%;" />
        - (上图是使用**IIC总线**的**EEPROM**)
    - **SPI**：
      - **串行外设接口**，用于**芯片间**通信，20世纪80年代由**摩托罗拉**设计。
    - **SATA**：
      - 计算机体系结构中的一种总线标准，负责**主板**和**大容量存储设备**(SATA固态硬盘/SATA机械硬盘)之间的数据传输。
      - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/1024px-MSATA_SSD_vs._2.5__SATA_drive.jpg" alt="1024px-MSATA_SSD_vs._2.5__SATA_drive" style="zoom:33%;" />
    - **PCIe**：
      - 计算机体系结构中的一种总线标准，负责**主板**和**各种外设**的连接。
      - 目前，**网卡**、**声卡**、**显卡**、**NVMe固态硬盘**都使用了**PCIe标准**。

- **并行通信—Parallel communication**：
  - 利用多个**数据通道**，将一个数据的**多位**同时传输。
    - 每个数据通道依旧传输**一个比特**的信息。
  - <img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/Serial_and_Parallel_Data_Transmission.svg.png" alt="Serial_and_Parallel_Data_Transmission.svg" style="zoom:50%;" />
  - **并行通信**除了用于传输数据的**数据通道**外，还需要其他的通道：
    - 调整数据流的时钟信号:clock10:
    - 控制数据流方向的信号:watermelon:
    - 握手信号:handshake:
    - ............
  - **并行通信**广泛用于**集成电路**、**外围总线**和**RAM**等存储设备中，但随着时间的推移，**并行通信**正在被**串行通信**取代:satisfied:。

#### 2.2 按照传输方向分类：

- **单工通信**：
  - 数据传输只能沿着一个方向传输，不能够实现反方向传输。
- **半双工通信**：
  - 数据传输可以沿着两个方向，但是不能同时进行双向传输。
- **全双工通信**：
  - 数据可以同时进行**双向传输**:haircut:。

<img src="https://nickaljy-pictures.oss-cn-hangzhou.aliyuncs.com/image-20231010165446033.png" alt="image-20231010165446033" style="zoom: 67%;" />

#### 2.3 按照同步方式分类：

- **同步通信**：
  - 通信双方使用统一的时钟信号来保证传输时序。
  - 可以实现高速的、大容量的数据传输，适合**单点对多点**的传输，但收发双方要保持**时钟的严格同步**，硬件实现较为复杂。
- **异步通信**：
  - 异步通信通过在**数据中加入同步信号**(例如**开始位**和**停止位**)使接收端能够将数据正确接收下来，某些通信协议中还需要双方约定**传输速率**。
  - 硬件设计较为简单，但通信速率较低，并且只适用于**点对点**传输。

## 3.通信速率：

#### 3.1 通信速率简介：

- 在数字通信系统中，通信速率指数据在信道中传输的速度，它分为两种：**比特率**和**波特率**。

#### 3.2 比特率：

- 每秒钟传输的**bit**数数量，单位**bit/s**。

#### 3.3 波特率：

- 每秒钟传输的码元数量，单位**Baud**。
- **码元**：
  - **码元**是信号被调制后的概念，每个**码元**都可以表示一定**bit**的数据信息量。
  - 如果码元采用**二进制编码**：
    - 比特率也是采用二进制编码，因此**波特率和比特率相等**。
  - 如果码元采用**十六进制编码**：
    - 码元有**0 ~ F**十六种，如果用二进制表示的话，每个码元需要对应**4bit**的二进制数，因此波特率是比特率的**4分之一**。

- 波特率和比特率的转换：

  - ![image-20230908215621650](C:\Users\nickaljy\AppData\Roaming\Typora\typora-user-images\image-20230908215621650.png)

  - 其中**M**表示码元的种类(对于十六进制来讲，码元有十六种)。
- 举例理解：

  - 波特率为**100Baud**，码元采用十六进制编码，这时候的比特率是**400bit/s**。

##### 在单片机的世界中，码元采用二进制编码，因此波特率等于比特率:astonished:。

